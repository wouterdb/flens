{
	"server":"127.0.0.1",
	"name" : "worker1",
	"tags" : { "tier" : "agent", "type":"worker", "service":"start"},
	"init":{
	"input" : {		
 		"heartbeat":{
			"type":"metric",
			"interval":10000
		},"collectd-in" : {
 			"type" : "metric",
			"add-tag" : "collectd"
 		},"grep":{
			"type":"log",
			"file":"../planB/java.log"
		},"JMXInput":{
			"type":"metric",
			"jvm":"sched",
			"domains" : ["metrics","metrics-details"],
			"add-tag" : "jmx"
		}
 	},
 	
 	"filter" : { 
 		"tag":{},
 		"sidestream timeings":{
 			"type":"log",
 			"plugin":"mvel",
 			"script":"if(isdef message && message ~= 'INFO: workflow .* took: .*'){x=message.split(' '); return new flens.core.Record('metric',['metric':'workflow.complete','value':x[4],'temporalScope':x[2]],new java.util.HashSet()); }"

 		},
 		"collectd name to metric" :{
 			"plugin" : "template",
 			"tags" : ["collectd"],
 			"template" : "@{plugin!=type?plugin+'.':''}@{type}",
 			"field":"metric"
 		},
		"rename" : {
			"tags": ["collectd"],
                        "remove-tag" : ["collectd"],
			"from": [ "type_instance"	,"plugin_instance"],
			"to":[ 	  "type"		,"instance"]
		},
 		"jmx name to metric" :{
 			"plugin" : "template",
 			"tags" : ["jmx"],
 			"template" : "@{plugin}@{(isdef type)?'.'+type:''}",
 			"field":"imetric"
 		},"jmx rename" : {
			"plugin" : "rename",
			"tags": ["jmx"],
            "remove-tag" : ["jmx"],
			"from": [ "plugin_instance","metric","imetric"],
			"to":[ "instance","type","metric"]
		},"json-encoder" : {
 			"add-tag" : ["json"],
 			"field" : "json",
 			"fields" : ["time","source","metric","value","type","instance","temporalScope","tenant","message","tags"] 
 		} 
		
	},
 	
 	"output" : {
		"amqp-out":{
			"exchange":"metrics",
            "tags":["json"],
			"host":"127.0.0.1",
			"field" : "json"
		},
		"amqp-out-logs":{
			"plugin":"amqp-out",
			"type": "log",
			"exchange":"logs",
             "tags":["json"],
			"host":"127.0.0.1",
			"field" : "json"
		},"system-out" : {
 			"name" : "out",
 			"type":"metric"	
 		}
 		
 	}
 	}
 		 

}
